<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>akrab super mini</title>

<style>
body{font-family:Arial;background:#f4f6f8;padding:20px}
.container{max-width:900px;background:#fff;padding:20px;border-radius:8px}
h2{text-align:center}

input,select,textarea,button{padding:10px;margin-top:8px}
.full{width:100%}

button{border:none;color:#fff;cursor:pointer}
.run{background:#007bff;width:49%}
.stop{background:#dc3545;width:49%}

.logs{display:flex;gap:10px;margin-top:15px}
.log{flex:1;max-height:260px;overflow:auto;border:1px solid #ddd;padding:10px;border-radius:6px}
.log h3{text-align:center;margin:0 0 8px 0;font-size:14px}

.log div{padding:6px;border-radius:4px;font-size:13px;margin-bottom:4px}
.ok{background:#d4edda}
.fail{background:#f8d7da}
.wait{background:#fff3cd}
</style>
</head>

<body>
<div class="container">

<h2>Multi Transaksi Unlimited</h2>

<label>Produk</label>
<select id="produk" class="full">
  <option value="XLA14">AKRAB super mini</option>
</select>

<label>Delay antar putaran (ms)</label>
<input id="delay" class="full" type="number" value="0">

<label>Daftar Nomor / ID (1 baris = 1 nomor)</label>
<textarea id="nomorList" class="full" rows="8"
placeholder="08123456789
08129876543
12345678901"></textarea>

<div style="display:flex;gap:2%;margin-top:10px">
  <button class="run" onclick="startSpam()">â–¶ START</button>
  <button class="stop" onclick="stopSpam()">â›” STOP</button>
</div>

<div class="logs">
  <div class="log" id="logSuccess">
    <h3>ðŸŸ¢ History Sukses</h3>
  </div>
  <div class="log" id="logFail">
    <h3>ðŸ”´ History Gagal</h3>
  </div>
</div>

</div>

<script>
  /* ===== KONFIG ===== */
  const API_KEY = "B65759AD-0035-4BFA-A552-B96D80F6557F";
  const API_URL = "https://panel.khfy-store.com/api_v2/trx";
  
  /* ===== STATE ===== */
  let isRunning = false;
  let round = 0;
  
  /* ===== UTIL ===== */
  const uuid = () => crypto.randomUUID();
  const sleep = ms => new Promise(r => setTimeout(r, ms));
  
  /* ===== LOG ===== */
  function logSuccess(msg){
    const d=document.createElement("div");
    d.className="ok";
    d.innerHTML=msg;
    document.getElementById("logSuccess").prepend(d);
  }
  
  function logFail(msg,cls="fail"){
    const d=document.createElement("div");
    d.className=cls;
    d.innerHTML=msg;
    document.getElementById("logFail").prepend(d);
  }
  
  /* ===== HIT API ===== */
  async function hitAPI(produk, tujuan){
    const reff = uuid();
    const url = `${API_URL}?produk=${produk}&tujuan=${tujuan}&reff_id=${reff}&api_key=${API_KEY}`;
  
    try{
      const r = await fetch(url);
      const d = await r.json();
  
      if(d && d.status === true){
        logSuccess(`âœ… [${tujuan}] SUKSES`);
        return { tujuan, success:true };
      }else{
        logFail(`âŒ [${tujuan}] GAGAL`);
      }
    }catch{
      logFail(`ðŸ”¥ [${tujuan}] API DOWN`);
    }
  
    return { tujuan, success:false };
  }
  
  /* ===== LOOP PARALLEL ===== */
  async function startSpam(){
    if(isRunning) return alert("Proses masih berjalan");
  
    const produk = document.getElementById("produk").value;
    const delay = parseInt(document.getElementById("delay").value||0);
  
    isRunning = true;
    round = 0;
    logFail("ðŸš€ TRANSAKSI DIMULAI","wait");
  
    while(isRunning){
      let list = document.getElementById("nomorList").value
        .split("\n")
        .map(x=>x.trim())
        .filter(x=>x);
  
      if(!list.length){
        logSuccess("ðŸŽ‰ SEMUA TRANSAKSI SUKSES â€“ SELESAI");
        break;
      }
  
      round++;
      logFail(`âš¡ PUTARAN ${round} (${list.length} nomor)`,`wait`);
  
      // ===== PROSES SEMUA NOMOR SEKALIGUS =====
      const results = await Promise.all(
        list.map(nomor => hitAPI(produk, nomor))
      );
  
      // ===== FILTER YANG GAGAL SAJA =====
      const gagal = results
        .filter(r => !r.success)
        .map(r => r.tujuan);
  
      document.getElementById("nomorList").value = gagal.join("\n");
  
      if(delay > 0) await sleep(delay);
    }
  
    isRunning = false;
    logFail("â›” PROSES BERHENTI");
  }
  
  function stopSpam(){
    isRunning = false;
  }
  </script>
  

</body>
</html>
